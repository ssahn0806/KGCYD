"use strict";(self["webpackChunkadmin_vue"]=self["webpackChunkadmin_vue"]||[]).push([[709],{3709:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var r=function(){var t=this,e=t._self._c;return e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],attrs:{id:"board"}},[e("b-card",{attrs:{"bg-variant":"light"}},[e("b-card-img",{staticStyle:{"max-width":"20rem"},attrs:{src:t.url,alt:"등록된이미지가 없습니다"},on:{click:t.openModal}}),e("hr"),e("b-row",{attrs:{"align-h":"center","align-v":"center"}},[e("b-col",{attrs:{cols:"7"}},[t._v("변경할 이미지 첨부")]),e("b-col",{attrs:{cols:"4"}},[e("b-form-file",{attrs:{accept:"image/*",placeholder:t.ph,"browse-text":"이미지 찾기"},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),e("b-col",[e("b-button",{attrs:{variant:"warning"},on:{click:t.clearFileInfo}},[t._v("삭제")])],1)],1),e("hr"),e("b-card-header",{staticStyle:{"border-radius":"10px"},attrs:{"header-bg-variant":"dark","header-border-variant":"dark","header-text-variant":"light"}},[e("b-form-input",{model:{value:t.article.subject,callback:function(e){t.$set(t.article,"subject",e)},expression:"article.subject"}})],1),e("hr"),e("b-row",{attrs:{"align-v":"center","align-h":"center"}},[e("b-col",{attrs:{cols:"4"}},[e("b-row",{attrs:{"align-v":"center"}},[e("b-col",{attrs:{cols:"4"}},[t._v("작성자 아이디")]),e("b-col",[e("b-form-input",{attrs:{readonly:""},model:{value:t.article.userId,callback:function(e){t.$set(t.article,"userId",e)},expression:"article.userId"}})],1)],1)],1),e("b-col",{attrs:{cols:"8"}},[e("b-row",{attrs:{"align-v":"center","align-h":"center"}},[e("b-col",{attrs:{cols:"4"}},[e("b-form-checkbox",{model:{value:t.article.event,callback:function(e){t.$set(t.article,"event",e)},expression:"article.event"}},[t._v("행사 글 여부")])],1),e("b-col",{attrs:{cols:"8"}},[e("b-row",{directives:[{name:"show",rawName:"v-show",value:t.article.event,expression:"article.event"}],attrs:{"align-v":"center"}},[e("b-col",[e("b-button",{attrs:{id:"btn1"},on:{click:function(e){return t.openPop(1)}}},[t._v(t._s(null!=t.article.startEvent?t.article.startEvent:"등록되지 않음"))]),e("b-popover",{attrs:{target:"btn1",title:"행사 시작일",triggers:"click",placement:"bottom",show:t.pop1}},[e("b-calendar",{attrs:{block:""},on:{input:function(e){return t.closePop(1)}},model:{value:t.article.startEvent,callback:function(e){t.$set(t.article,"startEvent",e)},expression:"article.startEvent"}})],1)],1),t._v(" ~ "),e("b-col",[e("b-button",{attrs:{id:"btn2"},on:{click:function(e){return t.openPop(2)}}},[t._v(t._s(t.article.endEvent?t.article.endEvent:"등록되지 않음"))]),e("b-popover",{attrs:{target:"btn2",title:"행사 종료일",triggers:"click",placement:"bottom",show:t.pop2}},[e("b-calendar",{attrs:{block:""},on:{input:function(e){return t.closePop(2)}},model:{value:t.article.endEvent,callback:function(e){t.$set(t.article,"endEvent",e)},expression:"article.endEvent"}})],1)],1)],1)],1)],1)],1)],1),e("hr"),e("b-form-textarea",{attrs:{"max-rows":"14"},model:{value:t.article.content,callback:function(e){t.$set(t.article,"content",e)},expression:"article.content"}}),e("b-row",{staticClass:"mr-0 mt-2",attrs:{"align-h":"end","align-v":"center"}},[e("b-button",{staticClass:"ml-2",attrs:{variant:"primary"},on:{click:function(e){return t.move(`/articles/detail/${t.articleNo}`)}}},[t._v("취소")]),e("b-button",{staticClass:"ml-2",attrs:{variant:"danger"},on:{click:t.onClickUpdate}},[t._v("수정")])],1)],1),e("b-modal",{attrs:{id:"imageViewer",size:"lg","ok-only":"","ok-title":"닫기"}},[e("b-embed",{attrs:{type:"embed",aspect:"4by3",src:t.url,allowfullscreen:""}})],1)],1)])},i=[],l=(a(7658),a(6731)),n={props:{articleNo:{type:String}},data(){return{visible:!1,article:{},baseUrl:"http://devsu.iptime.org",url:"",pop1:!1,pop2:!1,file:null,ph:""}},methods:{openModal(){this.$bvModal.show("imageViewer")},move(t){this.$router.push(t)},onClickUpdate(){if(this.article.event&&null==this.article.startEvent&&null==this.article.endEvent)return void alert("행사 글인 경우 기간을 등록해야 합니다.");let t=new FormData;t.append("board",new Blob([JSON.stringify(this.article)],{type:"application/json"})),t.append("upfile",this.file),(0,l.ip)(t,(()=>{this.move(`/articles/detail/${this.articleNo}`)}))},clearFileInfo(){this.file=null,this.ph=""},openPop(t){1!=t||this.pop1||(this.pop1=!0),2!=t||this.pop2||(this.pop2=!0)},closePop(t){1==t&&this.pop1&&(this.pop1=!1),2==t&&this.pop2&&(this.pop2=!1)},async convertURLtoFile(t){const e=await fetch(t),a=await e.blob(),r=t.split(".").pop(),i=t.split("/").pop(),l={type:`image/${r}`};return new File([a],i,l)}},created(){this.url=this.baseUrl+"/image/view/",(0,l.mx)(this.articleNo,(({data:t})=>{this.article={...t},this.url+=this.article.thumbnail,this.convertURLtoFile(this.url).then((t=>{this.file=t,this.ph=this.file.name,this.visible=!0}))}))},watch:{"article.event"(t){t||(this.article.endEvent||(this.article.endEvent=null),this.article.startEvent||(this.article.startEvent=null))},file(t){if(null!=t){const t=new FileReader;t.onload=t=>{this.url=t.target.result},t.readAsDataURL(this.file)}else this.url=""}}},s=n,o=a(1001),c=(0,o.Z)(s,r,i,!1,null,"0a8f2882",null),p=c.exports}}]);
//# sourceMappingURL=709.c4643343.js.map